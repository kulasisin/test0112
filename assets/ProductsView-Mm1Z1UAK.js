import{_ as x,o as r,c as g,a as t,n as l,F as f,r as _,t as n,b as w,d as m,e as y,f as k}from"./index-fkj0uQpA.js";const P={data(){return{}},props:["paginationObj"],watch:{paginationObj(){}},methods:{changePage(e){if(e.target.textContent==="Next")this.$emit("emit-selectPage",this.paginationObj.current_page+1);else if(e.target.textContent==="Previous")this.$emit("emit-selectPage",this.paginationObj.current_page-1);else{if(e.target.closest("li").className.includes("active"))return;this.$emit("emit-selectPage",e.target.textContent)}}},created(){},mounted(){}},j={class:"pagination justify-content-center"};function M(e,s,i,b,c,o){return r(),g("nav",null,[t("ul",j,[t("li",{class:l(["page-item",{disabled:!i.paginationObj.has_pre}])},[t("a",{class:l(["page-link",{"text-dark":!i.paginationObj.has_pre}]),onClick:s[0]||(s[0]=(...d)=>o.changePage&&o.changePage(...d))},"Previous",2)],2),(r(!0),g(f,null,_(i.paginationObj.total_pages,(d,a)=>(r(),g("li",{class:l(["page-item",{active:i.paginationObj.current_page===a+1}]),key:"key"+a},[t("a",{class:l(["page-link",{"text-dark":i.paginationObj.current_page===a+1}]),onClick:s[1]||(s[1]=(...h)=>o.changePage&&o.changePage(...h))},n(a+1),3)],2))),128)),t("li",{class:l(["page-item",{disabled:!i.paginationObj.has_next}])},[t("a",{class:l(["page-link",{"text-dark":!i.paginationObj.has_next}]),onClick:s[2]||(s[2]=(...d)=>o.changePage&&o.changePage(...d))},"Next",2)],2)])])}const S=x(P,[["render",M]]),u="https://ec-course-api.hexschool.io/",p="bftsai",v={data(){return{products:[],paginationObj:{},itemSelect:{},productsNum:0}},components:{pagination:S},props:["defaultTheme"],watch:{defaultTheme(){}},methods:{textDanger(e){if(!e&&this.defaultTheme==="light")return!0},textLight(e){if(!e&&this.defaultTheme==="dark")return!0},async getAllProducts(){try{const e=(await this.axios.get(`${u}v2/api/${p}/admin/products/all`)).data.products;this.productsNum=Object.keys(e)}catch(e){console.log(e.response.data)}},async getProducts(e){try{this.itemSelect={},this.product=[],this.$emit("emit-toggleLoading");const s=(await this.axios.get(`${u}v2/api/${p}/admin/products?page=${e}`)).data;this.products=s.products,this.paginationObj=s.pagination,this.$emit("emit-toggleLoading");const i={icon:"success",title:"已取得產品資料",timer:1500};this.$swal(i)}catch(s){console.log(s),this.$emit("emit-toggleLoading");const i={icon:"error",title:s.response.data.message};this.$swal(i)}},checkProduct(e){this.itemSelect=JSON.parse(JSON.stringify(e))},async postProduct(){try{const e={data:{title:"香蕉派",category:"蛋糕",origin_price:200,price:150,unit:"個",description:"呈現經典的美味及口感。",content:"尺寸：8寸",is_enabled:7,imageUrl:"https://images.unsplash.com/photo-1484723091739-30a097e8f929?w=800&auto=format&fit=crop&q=60&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8M3x8YmFuYW5hJTIwcGllfGVufDB8fDB8fHww",imagesUrl:["https://images.unsplash.com/photo-1616953343564-dcf52de3262c?w=800&auto=format&fit=crop&q=60&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8MTB8fGJhbmFuYSUyMHBpZXxlbnwwfHwwfHx8MA%3D%3D","https://images.unsplash.com/photo-1517777596324-5df4025800f2?w=800&auto=format&fit=crop&q=60&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8MTJ8fGJhbmFuYSUyMHBpZXxlbnwwfHwwfHx8MA%3D%3D","https://images.unsplash.com/photo-1636819232432-77f353ba39f8?w=800&auto=format&fit=crop&q=60&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8MTZ8fGJhbmFuYSUyMHBpZXxlbnwwfHwwfHx8MA%3D%3D"]}},s=await this.axios.post(`${u}v2/api/${p}/admin/product`,e);console.log(s)}catch(e){console.log(e)}},async checkLogin(){try{this.$emit("emit-toggleLoading");const e=document.cookie.replace(/(?:(?:^|.*;\s*)hexToken\s*=\s*([^;]*).*$)|^.*$/,"$1");this.axios.defaults.headers.common.Authorization=e;const s=(await this.axios.post(`${u}v2/api/user/check`)).data;s.success&&(this.$emit("emit-toggleLogin",s.success),this.getProducts(1)),this.$emit("emit-toggleLoading")}catch(e){this.$emit("emit-toggleLogin",e.response.data.success);const s={icon:"error",title:e.response.data.message,timer:1500};this.$swal(s),this.$emit("emit-toggleLoading"),e.response.data.success||this.$router.push("login")}},selectPage(e){this.getProducts(e)}},created(){this.$emit("emit-login"),this.checkLogin(),this.getAllProducts()}},O={class:"container"},T={class:"row"},D={class:"col-lg-6"},C=t("h1",null,"Products List",-1),H={class:"table table-hover"},L=t("thead",null,[t("tr",{class:"text-center"},[t("th",{scope:"col"},"產品名稱"),t("th",{scope:"col"},"原價"),t("th",{scope:"col"},"售價"),t("th",{scope:"col"},"是否啟用"),t("th",{scope:"col"},"查看細節")])],-1),B=["onClick"],N={key:0,class:"col-lg-6"},A=t("h2",null,"Product",-1),F=["src","alt"],Y={class:"card-body"},U={class:"card-title"},Z={class:"card-text"},J={class:"card-text"},z={class:"card-text"},V={class:"d-flex flex-wrap mb-3"},G=["src","alt"];function W(e,s,i,b,c,o){const d=k("pagination");return r(),g("div",O,[t("div",T,[t("div",D,[C,t("table",H,[L,t("tbody",null,[(r(!0),g(f,null,_(c.products,a=>(r(),g("tr",{key:a.title,class:"text-center"},[t("td",null,n(a.title),1),t("td",null,n(a.origin_price),1),t("td",null,n(a.price),1),t("td",{class:l({"text-danger":o.textDanger(a.is_enabled),"text-light":o.textLight(a.is_enabled)})},n(a.is_enabled?"啟用":"未啟用"),3),t("td",null,[t("button",{type:"button",class:l(["btn w-100",{"btn-secondary":i.defaultTheme==="light","btn-outline-primary":i.defaultTheme==="dark"}]),onClick:h=>o.checkProduct(a)},"查看細節",10,B)])]))),128))])]),w(d,{"pagination-obj":c.paginationObj,onEmitSelectPage:o.selectPage},null,8,["pagination-obj","onEmitSelectPage"])]),c.itemSelect.id?(r(),g("div",N,[A,t("div",{class:l(["card mb-3",{"border-primary":i.defaultTheme==="dark"}])},[t("img",{src:c.itemSelect.imageUrl,class:"card-img-top object-fit-contain",alt:c.itemSelect.title,height:"400"},null,8,F),t("div",Y,[t("h5",U,[m(n(c.itemSelect.title),1),t("span",{class:l(["badge ms-3",{" text-bg-secondary":i.defaultTheme==="light"," text-bg-primary":i.defaultTheme==="dark"}])},n(c.itemSelect.category),3)]),t("p",Z,"商品內容："+n(c.itemSelect.content),1),t("p",J,"商品描述："+n(c.itemSelect.description),1),t("p",z,[m(n(c.itemSelect.price)+" ",1),t("span",{class:l(["line-through",{"text-light":i.defaultTheme==="dark"}])},n(c.itemSelect.origin_price),3),m("元 / 個")])])],2),t("div",V,[(r(!0),g(f,null,_(c.itemSelect.imagesUrl,(a,h)=>(r(),g("img",{src:a,alt:"小圖"+h,key:"小圖"+h,height:"200",class:"me-3 mb-3"},null,8,G))),128))])])):y("",!0)])])}const $=x(v,[["render",W]]);export{$ as default};
